<!DOCTYPE html>
<html lang="no">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>TVEKAMP - Web vs DevOps</title>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Bangers&family=Poppins:wght@400;600;700&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="css/styles.css">
</head>
<body>
  <div class="background-animation"></div>

  <!-- Header -->
  <header>
    <h1 class="title">TVEKAMP</h1>
    <p class="subtitle">Web vs DevOps</p>
    <button id="authBtn" class="auth-btn" title="Admin Login">
      <span class="lock-icon">&#128274;</span>
    </button>
  </header>

  <!-- Navigation -->
  <nav>
    <button class="nav-btn active" data-section="wheel">Spin the Wheel</button>
    <button class="nav-btn" data-section="participants">Deltakere</button>
    <button class="nav-btn" data-section="games">Foreslå Spill</button>
    <button class="nav-btn" data-section="results">Resultater</button>
    <button class="nav-btn admin-only" data-section="admin">Admin</button>
  </nav>

  <!-- Main Content -->
  <main>
    <!-- Wheel Section -->
    <section id="wheel-section" class="section active">
      <div class="wheel-container">
        <div class="wheel-pointer"></div>
        <canvas id="wheel" width="400" height="400"></canvas>
      </div>
      <button id="spinBtn" class="spin-btn">SPIN!</button>
    </section>

    <!-- Participants Section -->
    <section id="participants-section" class="section hidden">
      <div class="section-header">
        <h2>Deltakere</h2>
        <button id="addParticipantBtn" class="btn btn-primary">+ Legg til</button>
      </div>

      <!-- Member Stats -->
      <div class="member-stats">
        <div class="stat-box web-stat">
          <span class="stat-number" id="webCount">0</span>
          <span class="stat-label">Web</span>
        </div>
        <div class="stat-box devops-stat">
          <span class="stat-number" id="devopsCount">0</span>
          <span class="stat-label">DevOps</span>
        </div>
        <div class="stat-box total-stat">
          <span class="stat-number" id="totalCount">0</span>
          <span class="stat-label">Totalt</span>
        </div>
      </div>

      <div class="teams-container">
        <div class="team team-web">
          <h3>Team Web</h3>
          <div id="webTeam" class="participants-grid"></div>
        </div>
        <div class="versus">VS</div>
        <div class="team team-devops">
          <h3>Team DevOps</h3>
          <div id="devopsTeam" class="participants-grid"></div>
        </div>
      </div>

      <!-- Add Participant Modal -->
      <div id="participantModal" class="modal hidden">
        <div class="modal-content">
          <button class="close-modal">&times;</button>
          <h2>Legg til Deltaker</h2>
          <form id="participantForm">
            <div class="form-group">
              <label for="name">Navn *</label>
              <input type="text" id="name" required>
            </div>
            <div class="form-group">
              <label for="team">Team</label>
              <select id="team" required>
                <option value="devops">DevOps</option>
                <option value="web">Web</option>
              </select>
            </div>
            <div class="form-group">
              <label for="funFact">Fun Fact</label>
              <textarea id="funFact" rows="2" placeholder="Noe morsomt om deg selv..."></textarea>
            </div>
            <div class="form-group">
              <label for="superpower">Superpower</label>
              <input type="text" id="superpower" placeholder="Din spesialferdighet...">
            </div>
            <div class="form-group">
              <label for="imageFile">Bilde</label>
              <div class="image-upload">
                <input type="file" id="imageFile" accept="image/*">
                <div id="imagePreview" class="image-preview"></div>
              </div>
            </div>
            <button type="submit" class="btn btn-primary">Legg til</button>
          </form>
        </div>
      </div>
    </section>

    <!-- Games Section (Everyone can suggest) -->
    <section id="games-section" class="section hidden">
      <div class="section-header">
        <h2>Foreslå Spill</h2>
        <button id="addGameBtn" class="btn btn-primary">+ Nytt Forslag</button>
      </div>
      <p class="section-desc">Har du en god idé til en tvekamp? Send inn forslaget ditt her! Admin bestemmer hvilke spill som kommer på hjulet.</p>

      <div class="suggestion-box">
        <h3>Dine forslag sendes til admin for godkjenning</h3>
        <p>Tenk på spill som er:</p>
        <ul>
          <li>Morsomme for alle</li>
          <li>Kan gjennomføres på kort tid</li>
          <li>Passer for 2 eller flere spillere</li>
        </ul>
      </div>

      <!-- Add Game Modal -->
      <div id="gameFormModal" class="modal hidden">
        <div class="modal-content">
          <button class="close-modal">&times;</button>
          <h2>Foreslå Spill</h2>
          <form id="gameForm">
            <div class="form-group">
              <label for="gameName">Navn på spillet *</label>
              <input type="text" id="gameName" required placeholder="F.eks. Stein, Saks, Papir">
            </div>
            <div class="form-group">
              <label for="gameRules">Regler *</label>
              <textarea id="gameRules" rows="4" required placeholder="Beskriv hvordan spillet fungerer..."></textarea>
            </div>
            <div class="form-group">
              <label for="gameTime">Estimert tid (minutter)</label>
              <input type="number" id="gameTime" min="1" value="5">
            </div>
            <div class="form-group">
              <label for="gamePlayers">Antall spillere</label>
              <input type="number" id="gamePlayers" min="1" value="2">
            </div>
            <button type="submit" class="btn btn-primary">Send Forslag</button>
          </form>
        </div>
      </div>
    </section>

    <!-- Results Section -->
    <section id="results-section" class="section hidden">
      <h2>Scoreboard</h2>
      <div class="scoreboard">
        <div class="score web-score">
          <span class="team-label">Web</span>
          <span id="webScore" class="score-number">0</span>
        </div>
        <div class="score-divider">-</div>
        <div class="score devops-score">
          <span class="team-label">DevOps</span>
          <span id="devopsScore" class="score-number">0</span>
        </div>
      </div>

      <h3>Kamphistorikk</h3>
      <div id="resultsHistory" class="results-history"></div>
    </section>

    <!-- Admin Section -->
    <section id="admin-section" class="section hidden admin-only">
      <div class="section-header">
        <h2>Administrer Spill</h2>
        <button id="adminAddGameBtn" class="btn btn-primary">+ Legg til Spill</button>
      </div>
      <p class="section-desc">Her ser du alle foreslåtte spill. Bruk toggle-knappen for å bestemme hvilke som vises på hjulet.</p>

      <div id="adminGamesList" class="games-list admin-games"></div>
    </section>
  </main>

  <!-- 3D Game Intro Overlay -->
  <div id="gameIntro" class="game-intro hidden">
    <div class="intro-content">
      <div class="intro-badge">NESTE UTFORDRING</div>
      <h1 class="intro-title" id="introGameName"></h1>
      <div class="intro-card">
        <div class="intro-icon">&#127918;</div>
        <div class="intro-details">
          <p class="intro-rules" id="introGameRules"></p>
          <div class="intro-meta">
            <span><strong>Tid:</strong> ca <span id="introGameTime"></span> min</span>
            <span><strong>Spillere:</strong> <span id="introGamePlayers"></span></span>
          </div>
        </div>
      </div>
      <button id="selectPlayersBtn" class="start-game-btn">VELG SPILLERE</button>
    </div>
    <div class="intro-particles"></div>
  </div>

  <!-- Select Players Modal -->
  <div id="selectPlayersModal" class="modal hidden">
    <div class="modal-content player-select-modal">
      <button class="close-modal">&times;</button>
      <h2>Velg Spillere</h2>
      <p class="game-name-display" id="playerSelectGameName"></p>

      <div class="player-selection">
        <div class="player-select-team web-team-select">
          <h3>Team Web</h3>
          <select id="selectWebPlayer" class="player-dropdown">
            <option value="">Velg spiller...</option>
          </select>
        </div>
        <div class="vs-badge">VS</div>
        <div class="player-select-team devops-team-select">
          <h3>Team DevOps</h3>
          <select id="selectDevopsPlayer" class="player-dropdown">
            <option value="">Velg spiller...</option>
          </select>
        </div>
      </div>

      <button id="startGameBtn" class="btn btn-primary btn-large">START KAMPEN!</button>
    </div>
  </div>

  <!-- Game Active Overlay with 3D Animation -->
  <div id="gameActive" class="game-active hidden">
    <!-- 3D Animated Background -->
    <div class="game-active-bg">
      <div class="floating-cube cube-1"></div>
      <div class="floating-cube cube-2"></div>
      <div class="floating-cube cube-3"></div>
      <div class="floating-cube cube-4"></div>
      <div class="floating-cube cube-5"></div>
      <div class="floating-cube cube-6"></div>
      <div class="pulse-ring ring-1"></div>
      <div class="pulse-ring ring-2"></div>
      <div class="pulse-ring ring-3"></div>
    </div>

    <div class="game-active-content">
      <div class="game-active-badge">
        <span class="badge-icon">⚔️</span>
        KAMP PÅGÅR
        <span class="badge-icon">⚔️</span>
      </div>

      <h2 class="game-active-title" id="activeGameName"></h2>

      <div class="active-players">
        <div class="active-player web-player">
          <div class="player-glow web-glow"></div>
          <span class="player-team-label">Web</span>
          <span class="player-name" id="activeWebPlayer">-</span>
        </div>
        <div class="active-vs">
          <div class="vs-circle">
            <span>VS</span>
          </div>
        </div>
        <div class="active-player devops-player">
          <div class="player-glow devops-glow"></div>
          <span class="player-team-label">DevOps</span>
          <span class="player-name" id="activeDevopsPlayer">-</span>
        </div>
      </div>

      <p class="game-active-rules" id="activeGameRules"></p>

      <button id="endGameBtn" class="end-game-btn">
        <span class="btn-text">FERDIG - REGISTRER VINNER</span>
        <span class="btn-glow"></span>
      </button>
    </div>
  </div>

  <!-- Delete Confirmation Modal -->
  <div id="deleteConfirmModal" class="modal hidden">
    <div class="modal-content delete-confirm-modal">
      <div class="delete-icon">⚠️</div>
      <h2>Slette spill?</h2>
      <p>Er du sikker på at du vil slette</p>
      <p class="delete-game-name" id="deleteGameName"></p>
      <div class="delete-buttons">
        <button id="cancelDeleteBtn" class="btn btn-secondary">Avbryt</button>
        <button id="confirmDeleteBtn" class="btn btn-danger">Ja, slett</button>
      </div>
    </div>
  </div>

  <!-- Auth Modal -->
  <div id="authModal" class="modal hidden">
    <div class="modal-content auth-modal">
      <button class="close-modal">&times;</button>
      <h2>Admin Login</h2>
      <form id="authForm">
        <div class="form-group">
          <label for="password">Passord</label>
          <input type="password" id="password" required>
        </div>
        <button type="submit" class="btn btn-primary">Logg inn</button>
      </form>
      <p id="authError" class="error hidden">Feil passord!</p>
    </div>
  </div>

  <!-- Register Result Modal -->
  <div id="resultModal" class="modal hidden">
    <div class="modal-content result-modal">
      <button class="close-modal">&times;</button>
      <h2>Hvem vant?</h2>
      <p class="result-game-name" id="resultGameDisplay"></p>

      <div class="result-players-display">
        <span id="resultWebPlayerName">Web</span>
        <span class="result-vs">vs</span>
        <span id="resultDevopsPlayerName">DevOps</span>
      </div>

      <form id="resultForm">
        <input type="hidden" id="resultGameId">
        <input type="hidden" id="resultGameName">
        <input type="hidden" id="resultWebPlayer">
        <input type="hidden" id="resultDevopsPlayer">

        <div class="winner-select">
          <label class="winner-option web-option">
            <input type="radio" name="winner" value="web" required>
            <span class="winner-card">
              <span class="winner-icon">&#128187;</span>
              <span class="winner-label">Team Web</span>
              <span class="winner-player" id="winnerWebName"></span>
            </span>
          </label>
          <label class="winner-option devops-option">
            <input type="radio" name="winner" value="devops" required>
            <span class="winner-card">
              <span class="winner-icon">&#9881;</span>
              <span class="winner-label">Team DevOps</span>
              <span class="winner-player" id="winnerDevopsName"></span>
            </span>
          </label>
        </div>

        <button type="submit" class="btn btn-primary btn-large">Registrer Seier!</button>
      </form>
    </div>
  </div>

  <!-- Confetti Canvas -->
  <canvas id="confetti"></canvas>

  <script src="js/api.js"></script>
  <script src="js/auth.js"></script>
  <script src="js/wheel.js"></script>
  <script src="js/app.js"></script>
</body>
</html>
